function PPTBox(){this.uid=PPTBoxHelper.getId(),PPTBoxHelper.instance[this.uid]=this,this._$=function(t){return document.getElementById(t)},this.width=400,this.height=300,this.picWidth=15,this.picHeight=12,this.autoplayer=4,this.target="_blank",this._box=[],this._curIndex=0}function moveElement(t,i,e){if(!document.getElementById)return!1;if(!document.getElementById(t))return!1;var a=document.getElementById(t);a.movement&&clearTimeout(a.movement),a.style.left||(a.style.left="0px");var s=parseInt(a.style.left);if(s==i)return!0;if(i>s){var h=Math.ceil((i-s)/5);s+=h}if(s>i){var h=Math.ceil((s-i)/5);s-=h}a.style.left=s+"px";var o="moveElement('"+t+"',"+i+","+e+")";a.movement=setTimeout(o,e)}PPTBox.prototype={_createMainBox:function(){var t=this.width*this._box.length+5,i="<div id='"+this.uid+"_mainbox' class='mainbox'  style='width:"+this.width+"px;height:"+(this.height+2)+"px;'>";i+="<div id='"+this.uid+"_flashbox' class='flashbox' style='width:"+t+"px;height:"+(this.height+2)+"px;'></div>",i+="<div id='"+this.uid+"_imagebox' class='imagebox' style='width:"+this.width+"px;height:"+(this.picHeight+2)+"px;top:-"+(this.picHeight+20)+"px;'></div>",i+="</div>",document.write(i)},_init:function(){for(var t="",i="PPTBoxHelper.instance['"+this.uid+"']",e="",a="",s=0;s<this._box.length;s++){var h=this._box[s];a+=this.flashHTML(h.url,this.width,this.height,s),e="<div class='bitdiv "+(0==s?"curimg":"defimg")+"' title ="+h.title+" src='bit01.gif' "+t+' onclick = "'+i+".clickPic("+s+')"  onmouseover="'+i+".mouseoverPic("+s+')"></div>'+e}this._$(this.uid+"_flashbox").innerHTML=a,this._$(this.uid+"_imagebox").innerHTML=e},_play:function(){clearInterval(this._autoplay);var t=this._curIndex+1;t>=this._box.length&&(t=0),this.changeIndex(t);var i="PPTBoxHelper.instance['"+this.uid+"']._play()";this._autoplay=setInterval(i,1e3*this.autoplayer)},flashHTML:function(t,i,e,a){var s="swf"==t.substring(t.lastIndexOf(".")+1).toLowerCase(),h="";if(s)h="<object classid='clsid:D27CDB6E-AE6D-11cf-96B8-444553540000' codebase='http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=7,0,19,0' width='"+i+"' height='"+e+'\'><param name="movie" value="'+t+"\" /><param name='quality' value='high' /><param name='wmode' value='transparent'><embed src='"+t+"' quality='high' wmode='opaque' pluginspage='http://www.macromedia.com/go/getflashplayer'  type='application/x-shockwave-flash' width="+i+" height='"+e+"'></embed>  </object>";else{var o="PPTBoxHelper.instance['"+this.uid+"']",n="";this._box[a].href&&(n="cursor:pointer"),h='<img onmouseover= "'+o+'.stop()" onmouseout="'+o+".goonplay()\" src='"+t+"' style='width:"+i+"px;height:"+e+"px;"+n+"' onclick = \""+o+".clickPic("+a+')"/>'}return h},changeIndex:function(t){this._box[t];moveElement(this.uid+"_flashbox",-(t*this.width),1);var i=this._$(this.uid+"_imagebox").getElementsByTagName("div");i[this._box.length-1-this._curIndex].className="bitdiv defimg",i[this._box.length-1-t].className="bitdiv curimg",this._curIndex=t},mouseoverPic:function(t){if(this.changeIndex(t),this.autoplayer>0){clearInterval(this._autoplay);var i="PPTBoxHelper.instance['"+this.uid+"']._play()";this._autoplay=setInterval(i,1e3*this.autoplayer)}},clickPic:function(t){var i=this._box[t];i.href&&""!=i.href&&window.open(i.href,this.target)},add:function(t){this._box[this._box.length]=t},show:function(){if(this._createMainBox(),this._init(),this.autoplayer>0){var t="PPTBoxHelper.instance['"+this.uid+"']._play()";this._autoplay=setInterval(t,1e3*this.autoplayer)}},stop:function(){clearInterval(this._autoplay)},goonplay:function(){var t="PPTBoxHelper.instance['"+this.uid+"']._play()";this._autoplay=setInterval(t,1e3*this.autoplayer)}};var PPTBoxHelper={count:0,instance:{},getId:function(){return"_ppt_box-"+this.count++}};